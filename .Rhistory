############################################################ DISTANCES ######################################################
nn_function <- function(measureFrom,measureTo,k) {
measureFrom_Matrix <- as.matrix(measureFrom)
measureTo_Matrix <- as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist [,k]
return(nn)
}
funda_data <- funda_data %>%
mutate(tram_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(tram$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(train_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(train$geometry), 1))
raster100 <- read_stars("data/Greenness/NDVI_Amsterdam_100m.tif")
raster300 <- read_stars("data/Greenness/NDVI_Amsterdam_300m.tif")
raster500 <- read_stars("data/Greenness/NDVI_Amsterdam_500m.tif")
ndvi100 <- st_extract(raster100, funda_data)
ndvi300 <- st_extract(raster300, funda_data)
ndvi500 <- st_extract(raster500, funda_data)
funda_data$ndvi100 <- ndvi100$NDVI_Amsterdam_100m.tif
funda_data$ndvi300 <- ndvi300$NDVI_Amsterdam_300m.tif
funda_data$ndvi500 <- ndvi500$NDVI_Amsterdam_500m.tif
#write results to updated gpkg
st_write(funda_data, "data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap")
#Visualize results GWR model
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
View(gwr_result)
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi100_TV < -1.96| ndvi100_TV > 1.96) %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi100_TV < -1.96| ndvi100_TV > 1.96) %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi100_TV < -1.96| ndvi100_TV > 1.96) %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap")
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi200", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi.gpkg")
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.96| ndvi500_TV > 1.96) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.96| ndvi500_TV > 1.96) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi_m2.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.96| ndvi500_TV > 1.96) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "price_", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "price", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
filter(price < 2500000) %>%
mapview( zcol = "price", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
filter(price < 2000000) %>%
mapview( zcol = "price", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
filter(price < 2000000) %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
filter(price_m2 < 10000) %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
filter(price_m2 < 15000) %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), breaks = c(4000, 6000, 8000, 10000, 14000, 20000))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(15, "YlOrRd"), breaks = c(4000, 6000, 8000, 10000, 14000, 20000))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(15, "YlOrRd"))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(15, "YlOrRd"), at = seq(4000, 25000, 200))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
funda_data %>%
mapview( zcol = "price", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
funda_data %>%
mapview( zcol = "price", col.regions=brewer.pal(9, "YlOrRd"), at = seq(100000, 2500000, 100000))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(100000, 2500000, 100000))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
ggplot(aes(y = price, x = living_area)) + geom_point()
funda_data %>%
ggplot(aes(y = price_m2, x = living_area)) + geom_point()
funda_data %>%
ggplot(aes(y = price, x = ndvi500)) + geom_point()
funda_data %>%
ggplot(aes(y = price, x = ndvi100)) + geom_point()
funda_data %>%
ggplot(aes(y = price, x = ndvi300)) + geom_point()
funda_data %>%
ggplot(aes(y = price_m2, x = ndvi300)) + geom_point()
funda_data %>%
ggplot(aes(y = price_m2, x = ndvi100)) + geom_point()
funda_data %>%
ggplot(aes(y = price_m2, x = ndvi500)) + geom_point()
funda_data %>%
ggplot(aes(y = price_m2, x = train_dist)) + geom_point()
funda_data %>%
ggplot(aes(y = price_m2, x = tram_dist)) + geom_point()
funda_data %>%
ggplot(aes(y = price_m2, x = metro_dist)) + geom_point()
funda_data %>%
ggplot(aes(y = price, x = metro_dist)) + geom_point()
funda_data %>%
ggplot(aes(y = price, x = tram_dist)) + geom_point()
funda_data %>%
ggplot(aes(y = price, x = train_dist)) + geom_point()
funda_data %>%
ggplot(aes(y = price_m2, x = metro_dist)) + geom_point()
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi_m2.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(school_dist_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(school_dist_TV < -1.91| school_dist_TV > 1.91) %>%
mapview( zcol = "school_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(shops_dist_TV < -1.91| shops_dist_TV > 1.91) %>%
mapview( zcol = "shops_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(centre_dist_TV < -1.91| centre_dist_TV > 1.91) %>%
mapview( zcol = "centre_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(zuid_dist_TV < -1.91| zuid_dist_TV > 1.91) %>%
mapview( zcol = "zuid_dist", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
ggplot(aes(y = price_m2, x = metro_dist)) + geom_point()
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi_m2.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(school_dist_TV < -1.91| school_dist_TV > 1.91) %>%
mapview( zcol = "school_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(shops_dist_TV < -1.91| shops_dist_TV > 1.91) %>%
mapview( zcol = "shops_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(centre_dist_TV < -1.91| centre_dist_TV > 1.91) %>%
mapview( zcol = "centre_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(zuid_dist_TV < -1.91| zuid_dist_TV > 1.91) %>%
mapview( zcol = "zuid_dist", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(school_dist_TV < -1.91| school_dist_TV > 1.91) %>%
mapview( zcol = "school_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi_m2.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(school_dist_TV < -1.91| school_dist_TV > 1.91) %>%
mapview( zcol = "school_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(shops_dist_TV < -1.91| shops_dist_TV > 1.91) %>%
mapview( zcol = "shops_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(centre_dist_TV < -1.91| centre_dist_TV > 1.91) %>%
mapview( zcol = "centre_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(zuid_dist_TV < -1.91| zuid_dist_TV > 1.91) %>%
mapview( zcol = "zuid_dist", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi_m2.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi_m2.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
funda_data %>%
mapview( zcol = "price_m2", col.regions=brewer.pal(9, "YlOrRd"), at = seq(4000, 25000, 1000))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi500_TV < -1.91| ndvi500_TV > 1.91) %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(school_dist_TV < -1.91| school_dist_TV > 1.91) %>%
mapview( zcol = "school_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(shops_dist_TV < -1.91| shops_dist_TV > 1.91) %>%
mapview( zcol = "shops_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
mapview( zcol = "residual", col.regions=brewer.pal(9, "YlOrRd"))
tm_shape(PC4)+
tm_polygons()+
tm_shape(gwr_result)+
tm_dots(c("train_dist")) +
tm_layout(legend.position = c("right", "top"),
legend.text.size = 0.5, legend.title.size = 0.8)
funda_KNN <- knearneigh(funda_data, k=5)
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap", "spdep")
gwr_result %>%
mapview( zcol = "residual", col.regions=brewer.pal(9, "YlOrRd"))
funda_KNN <- knearneigh(funda_data, k=5)
mc_gwr <- moran.mc(gwr_result$residual, funda_KNN_w, 2999, zero.policy= TRUE, alternative="greater")
funda_KNN <- knearneigh(funda_data, k=5) #Identify k nearest neighbours for spatial weights
funda_nbq_KNN <- knn2nb(funda_KNN, sym=T) #Neighbours list from knn object
funda_KNN_w <- nb2listw(funda_nbq_KNN, style="W", zero.policy = TRUE)
mc_gwr <- moran.mc(gwr_result$residual, funda_KNN_w, 2999, zero.policy= TRUE, alternative="greater")
mc_gwr
plot(mc_gwr)
