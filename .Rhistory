mapview( zcol = "metro", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
#filter(metro_TV < -1.96| metro_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
ggplot(aes(x = residual)) + geom_density()
equation <- price ~ room + bedroom + bathroom + living_area + house_age + tram + metro
#OLS
model <- lm(equation,
data = funda_data)
summary(model)
trein <- st_transform(st_read("data/Amsterdam/Stations_(NS).geojson"), crs= 28992)
View(trein)
##### Amsterdam
nn_function <- function(measureFrom,measureTo,k) {
measureFrom_Matrix <- as.matrix(measureFrom)
measureTo_Matrix <- as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist [,k]
return(nn)
}
amsterdam_boundaries <- st_transform(st_read("data/Amsterdam/PC4.json"), crs= 28992)
amsterdam_network <- st_transform(st_read("data/Amsterdam/streets.json"), crs= 28992)
public_transport <- st_transform(st_read("data/Amsterdam/public_transport.json"), crs= 28992)
trein <- st_transform(st_read("data/Amsterdam/Stations_(NS).geojson"), crs= 28992)
tram <- public_transport %>%
filter(Modaliteit == "Tram")
metro <- public_transport %>%
filter(Modaliteit == "Metro")
funda_data <- st_read ("data/funda_buy_amsterdam_31-03-2023_full.gpkg")
funda_data <- funda_data %>%
mutate(tram_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(tram$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(train_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(trein$geometry), 1))
#write results to updated gpkg
st_write(funda_data, "data/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
easypackages::packages("sf", "sp", "osmdata", "FNN", "tidyverse")
##### Amsterdam
nn_function <- function(measureFrom,measureTo,k) {
measureFrom_Matrix <- as.matrix(measureFrom)
measureTo_Matrix <- as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist [,k]
return(nn)
}
amsterdam_boundaries <- st_transform(st_read("data/Amsterdam/PC4.json"), crs= 28992)
amsterdam_network <- st_transform(st_read("data/Amsterdam/streets.json"), crs= 28992)
public_transport <- st_transform(st_read("data/Amsterdam/public_transport.json"), crs= 28992)
trein <- st_transform(st_read("data/Amsterdam/Stations_(NS).geojson"), crs= 28992)
tram <- public_transport %>%
filter(Modaliteit == "Tram")
metro <- public_transport %>%
filter(Modaliteit == "Metro")
funda_data <- st_read ("data/funda_buy_amsterdam_31-03-2023_full.gpkg")
funda_data <- funda_data %>%
mutate(tram_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(tram$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(train_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(trein$geometry), 1))
#write results to updated gpkg
st_write(funda_data, "data/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
##### Amsterdam
nn_function <- function(measureFrom,measureTo,k) {
measureFrom_Matrix <- as.matrix(measureFrom)
measureTo_Matrix <- as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist [,k]
return(nn)
}
amsterdam_boundaries <- st_transform(st_read("data/Amsterdam/PC4.json"), crs= 28992)
amsterdam_network <- st_transform(st_read("data/Amsterdam/streets.json"), crs= 28992)
public_transport <- st_transform(st_read("data/Amsterdam/public_transport.json"), crs= 28992)
trein <- st_transform(st_read("data/Amsterdam/Stations_(NS).geojson"), crs= 28992)
tram <- public_transport %>%
filter(Modaliteit == "Tram")
metro <- public_transport %>%
filter(Modaliteit == "Metro")
funda_data <- st_read ("data/funda_buy_amsterdam_31-03-2023_full.gpkg")
funda_data <- funda_data %>%
mutate(tram_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(tram$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(train_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(trein$geometry), 1))
#write results to updated gpkg
st_write(funda_data, "data/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
easypackages::packages("sf", "sp", "osmdata", "FNN", "tidyverse")
province_boundaries <- st_read ("data/Noord_Holland.gpkg")
funda_data <- st_read ("data/funda_buy_28-03-2023_full.gpkg")
trein <- st_transform(st_read("data/Amsterdam/Stations_(NS).geojson"), crs= 28992)
#This function take an origin point (from), and a destination point (to), and then use nn function of FNN package to estimate the distance to the nearest (k =1) neighborhood location
nn_function <- function(measureFrom,measureTo,k) {
measureFrom_Matrix <- as.matrix(measureFrom)
measureTo_Matrix <- as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist [,k]
return(nn)
}
#distance to train station
funda_data <- funda_data %>%
mutate(train_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(trein$geometry), 1))
#write results to updated gpkg
st_write(funda_data, "data/funda_buy_28-03-2023_full_distances.gpkg")
#write results to updated gpkg
st_write(funda_data, "data/funda_buy_28-03-2023_full_distances.gpkg")
gwr_result<- st_read("data/gwr_results_full.gpkg")
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
View(gwr_result)
gwr_result %>%
ggplot(aes(x = yhat+residual)) + geom_density()
gwr_result<- st_read("data/gwr_results_full.gpkg")
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
gwr_result %>%
ggplot(aes(x = yhat+residual)) + geom_density()
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
gwr_result %>%
ggplot(aes(x = yhat+residual)) + geom_density()
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
gwr_result %>%
ggplot(aes(x = yhat+residual)) + geom_density()
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
ggplot(aes(x = yhat+residual)) + geom_density()
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
View(gwr_result)
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_d > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
st_bbox(PC4)
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap")
#Visualize results GWR model
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
map <- mapview(gwr_result, zcol = "metro", col.regions=brewer.pal(9, "YlOrRd"))
map
#Visualize results GWR model
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
tm_shape(PC4)+
tm_polygons()+
tm_shape(gwr_result)+
tm_dots(c("train_dist"), style = "log10_pretty") +
tm_layout(legend.position = c("right", "top"),
legend.text.size = 0.5, legend.title.size = 0.8)
tm_shape(PC4)+
tm_polygons()+
tm_shape(gwr_result)+
tm_dots(c("train_dist")) +
tm_layout(legend.position = c("right", "top"),
legend.text.size = 0.5, legend.title.size = 0.8)
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/gwr_results_full.gpkg")
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
#filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "residual", col.regions=brewer.pal(9, "YlOrRd"))
equation <- price ~ room + bedroom + bathroom + living_area + house_age + tram_dist + metro_dist
#OLS
model <- lm(equation,
data = funda_data)
summary(model)
funda_data$res_lm <- model$residuals
#Now plot the residuals
mapview(funda_data, zcol = "res_lm", col.regions=brewer.pal(9, "YlOrRd"))
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap", "car", "spdep", "spatialreg", "leafsync")
#load data
funda_data <- st_read("data/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
equation <- price ~ room + bedroom + bathroom + living_area + house_age + tram_dist + metro_dist
#OLS
model <- lm(equation,
data = funda_data)
summary(model)
funda_data$res_lm <- model$residuals
#Now plot the residuals
mapview(funda_data, zcol = "res_lm", col.regions=brewer.pal(9, "YlOrRd"))
funda_data <- st_read("data/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
PC4 <- st_transform(st_read("data/Amsterdam/PC4.json"), crs = 28992)
tm_shape(PC4)+
tm_polygons()+
tm_shape(gwr_result)+
tm_dots(c("train_dist")) +
tm_layout(legend.position = c("right", "top"),
legend.text.size = 0.5, legend.title.size = 0.8)
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap")
#Visualize results GWR model
gwr_result<- st_read("data/gwr_results_full.gpkg")
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/mgwr_results_full.gpkg")
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/mgwr_results_amsterdam.gpkg")
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/mgwr_results_amsterdam.gpkg")
View(gwr_result)
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96)
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
####
# 1. Initialise
####
# Load Packages
library(tmap)
library(tidyverse)
library(stars)
raster <- read_stars("data/Greenness/NDVI_Amsterdam_100m/tif")
raster <- read_stars("data/Greenness/NDVI_Amsterdam_100m.tif")
easypackages::packages("sf", "sp", "osmdata", "FNN", "tidyverse")
############################################################ AMSTERDAM ###########################################################
############################################################ DATA ###########################################################
funda_data <- st_transform(st_read("data/funda_buy_amsterdam_31-03-2023_full.gpkg"), crs = 28992)
st_extract(raster, funda_data)
ndvi <- st_extract(raster, funda_data)
View(ndvi)
View(funda_data)
ndvi <- st_extract(raster, funda_data) %>% drop_geometry()
View(ndvi)
easypackages::packages("sf", "sp", "osmdata", "FNN", "tidyverse", "stars")
############################################################ AMSTERDAM ###########################################################
############################################################ DATA ###########################################################
funda_data <- st_transform(st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full.gpkg"), crs = 28992)
amsterdam_boundaries <- st_transform(st_read("data/Amsterdam/PC4.json"), crs= 28992)
public_transport <- st_transform(st_read("data/Amsterdam/public_transport.json"), crs= 28992)
tram <- public_transport %>%
filter(Modaliteit == "Tram")
metro <- public_transport %>%
filter(Modaliteit == "Metro")
train <- st_transform(st_read("data/Amsterdam/Stations_(NS).geojson"), crs= 28992)
############################################################ DISTANCES ######################################################
nn_function <- function(measureFrom,measureTo,k) {
measureFrom_Matrix <- as.matrix(measureFrom)
measureTo_Matrix <- as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist [,k]
return(nn)
}
funda_data <- funda_data %>%
mutate(tram_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(tram$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(train_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(train$geometry), 1))
raster100 <- read_stars("data/Greenness/NDVI_Amsterdam_100m.tif")
raster300 <- read_stars("data/Greenness/NDVI_Amsterdam_300m.tif")
raster500 <- read_stars("data/Greenness/NDVI_Amsterdam_500m.tif")
ndvi100 <- st_extract(raster100, funda_data)
ndvi300 <- st_extract(raster300, funda_data)
ndvi500 <- st_extract(raster500, funda_data)
funda_data$ndvi100 <- ndvi100$NDVI_Amsterdam_100m.tif
funda_data$ndvi300 <- ndvi300$NDVI_Amsterdam_100m.tif
funda_data$ndvi500 <- ndvi500$NDVI_Amsterdam_100m.tif
View(funda_data)
funda_data$ndvi300 <- ndvi300$NDVI_Amsterdam_100m.tif
funda_data$ndvi300 <- ndvi300$NDVI_Amsterdam_300m.tif
#write results to updated gpkg
st_write(funda_data, "data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
easypackages::packages("sf", "sp", "osmdata", "FNN", "tidyverse", "stars")
############################################################ AMSTERDAM ###########################################################
############################################################ DATA ###########################################################
funda_data <- st_transform(st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full.gpkg"), crs = 28992)
amsterdam_boundaries <- st_transform(st_read("data/Amsterdam/PC4.json"), crs= 28992)
public_transport <- st_transform(st_read("data/Amsterdam/public_transport.json"), crs= 28992)
tram <- public_transport %>%
filter(Modaliteit == "Tram")
metro <- public_transport %>%
filter(Modaliteit == "Metro")
train <- st_transform(st_read("data/Amsterdam/Stations_(NS).geojson"), crs= 28992)
############################################################ DISTANCES ######################################################
nn_function <- function(measureFrom,measureTo,k) {
measureFrom_Matrix <- as.matrix(measureFrom)
measureTo_Matrix <- as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist [,k]
return(nn)
}
funda_data <- funda_data %>%
mutate(tram_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(tram$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(metro_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(metro$geometry), 1))
funda_data <- funda_data %>%
mutate(train_dist = nn_function(st_coordinates(funda_data$geom), st_coordinates(train$geometry), 1))
raster100 <- read_stars("data/Greenness/NDVI_Amsterdam_100m.tif")
raster300 <- read_stars("data/Greenness/NDVI_Amsterdam_300m.tif")
raster500 <- read_stars("data/Greenness/NDVI_Amsterdam_500m.tif")
ndvi100 <- st_extract(raster100, funda_data)
ndvi300 <- st_extract(raster300, funda_data)
ndvi500 <- st_extract(raster500, funda_data)
funda_data$ndvi100 <- ndvi100$NDVI_Amsterdam_100m.tif
funda_data$ndvi300 <- ndvi300$NDVI_Amsterdam_300m.tif
funda_data$ndvi500 <- ndvi500$NDVI_Amsterdam_500m.tif
#write results to updated gpkg
st_write(funda_data, "data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap")
#Visualize results GWR model
gwr_result<- st_read("data/gwr_results_amsterdam.gpkg")
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
View(gwr_result)
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96) %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi100_TV < -1.96| ndvi100_TV > 1.96) %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi100_TV < -1.96| ndvi100_TV > 1.96) %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi300", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
#Visualize results GWR model
gwr_result<- st_read("data/models/mgwr_results_amsterdam_ndvi.gpkg")
gwr_result %>%
filter(tram_dist_TV < -1.96| tram_dist_TV > 1.96) %>%
mapview( zcol = "tram_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(train_dist_TV < -1.96| train_dist_TV > 1.96) %>%
mapview( zcol = "train_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(metro_dist_TV < -1.96| metro_dist_TV > 1.96) %>%
mapview( zcol = "metro_dist", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(living_area_TV < -1.96| living_area_TV > 1.96) %>%
mapview( zcol = "living_area", col.regions=brewer.pal(9, "YlOrRd"))
gwr_result %>%
filter(ndvi100_TV < -1.96| ndvi100_TV > 1.96) %>%
mapview( zcol = "ndvi100", col.regions=brewer.pal(9, "YlOrRd"))
funda_data %>%
mapview( zcol = "ndvi500", col.regions=brewer.pal(9, "YlOrRd"))
