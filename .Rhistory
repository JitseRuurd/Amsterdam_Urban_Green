tm_layout(title = "Amsterdam house prices",
title.fontfamily = "cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = terrain.colors(8),
breaks = c(-100000,-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
my_palette <- terrain.colors(10)[3:9]
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette(),
breaks = c(-100000,-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
library(RColorBrewer)
my_palette <- terrain.colors(10)[3:9]
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette(),
breaks = c(-100000,-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "Cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
library(RColorBrewer)
my_palette <- brewer.pal(name="Oranges",n=9)[4:9]
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,0,25000,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,-25000,0,25000,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-75000,-50000,-25000,0,25000,50000,75000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = terrain.colors(10),
breaks = c(-100000,-75000,-50000,-25000,0,25000,50000,75000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = "YlGn",
breaks = c(-100000,-75000,-50000,-25000,0,25000,50000,75000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-75000,-50000,-25000,0,25000,50000,75000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
my_palette <- brewer.pal(name="Oranges",n=9)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-75000,-50000,-25000,0,25000,50000,75000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
my_palette <- brewer.pal(name="Oranges",n=20)[1:9]
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,-25000,0,25000,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
my_palette <- brewer.pal(name="Oranges",n=9)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,-25000,0,25000,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
my_palette <- brewer.pal(name="Oranges",n=9)[1:8]
my_palette <- brewer.pal(name="Oranges",n=9)[1:8]
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,-25000,0,25000,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = my_palette,
breaks = c(-100000,-50000,0,50000,100000)) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "Cambria",
legend.title.fontfamily = "ambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1, +
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1'' +
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1'' +
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
midpoint = NA) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
midpoint = NA) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
midpoint = NA,
palette = "PyIg") +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
midpoint = NA,
palette = "PyIg") +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
midpoint = NA,
palette = "PiYg") +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
midpoint = NA,
palette = "PiYG") +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1,
palette = "PiYG") +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Price (m2)", size = 0.1) +
tm_layout(title = "Amsterdam house prices",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Coefficient", size = 0.1) +
tm_layout(title = "NDVI coefficients GWR model",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Coefficient", size = 0.1) +
tm_layout(title = "Significant (95%) NDVI coefficients GWR model",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
n
#test global spatial autocorrelation with Moran's I
funda_KNN <- knearneigh(funda_data, k=5) #Identify k nearest neighbours for spatial weights
View(funda_KNN)
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap", "spdep")
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi300_m2.gpkg")
funda_data <- st_read("data/Houseprices/funda_buy_amsterdam_31-03-2023_full_distances.gpkg")
library(RColorBrewer)
my_palette <- terrain.colors(10)[3:9]
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Coefficient", size = 0.1) +
tm_layout(title = "Significant (95%) NDVI coefficients GWR model",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi300_m2.gpkg")
PC4 <- st_transform(st_read("data/Amsterdam/PC4.json"), crs = 28992)
library(RColorBrewer)
my_palette <- terrain.colors(10)[3:9]
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Coefficient", size = 0.1) +
tm_layout(title = "Significant (95%) NDVI coefficients GWR model",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
easypackages::packages("tidyverse", "sf", "mapview", "RColorBrewer", "tmap", "spdep")
#Visualize results GWR model
gwr_result<- st_read("data/models/gwr_results_amsterdam_ndvi300_m2.gpkg")
PC4 <- st_transform(st_read("data/Amsterdam/PC4.json"), crs = 28992)
#plot variables of interest
# Extend bbox for plots
bbox_new <- st_bbox(PC4) # current bounding box
xrange <- bbox_new$xmax - bbox_new$xmin # range of x values
yrange <- bbox_new$ymax - bbox_new$ymin # range of y values
# bbox_new[1] <- bbox_new[1] - (0.25 * xrange) # xmin - left
bbox_new[3] <- bbox_new[3] + (0.25 * xrange) # xmax - right
# bbox_new[2] <- bbox_new[2] - (0.25 * yrange) # ymin - bottom
bbox_new[4] <- bbox_new[4] + (0.25 * yrange) # ymax - top
bbox_new <- bbox_new %>%
st_as_sfc()
library(RColorBrewer)
my_palette <- terrain.colors(10)[3:9]
tm_shape(PC4, bbox = bbox_new)+
tm_polygons(col = "white", alpha = 0, border.col = "Black")+
tm_shape(gwr_result %>%  filter(ndvi300_TV < -1.96| ndvi300_TV > 1.96))+
tm_dots(c("ndvi300"), title = "Coefficient", size = 0.1) +
tm_layout(title = "Significant (95%) NDVI coefficients GWR model",
title.fontfamily = "Cambria",
title.fontface = "bold",
legend.text.fontfamily = "cambria",
legend.title.fontfamily = "cambria",
legend.position = c("right", "top"),
legend.text.size = 0.75,
legend.title.size = 1)
